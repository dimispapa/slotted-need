{% extends 'base.html' %}
{% block content %}
<div class="container mt-2 mt-md-4">
  <h1>Orders</h1>
  <!-- Form start -->
  <form method="post" id="order-list-form" action="{% url 'orders' %}">
    {% csrf_token %}
    <!-- Orders table -->
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <!-- Formset management hidden fields -->
        {{ formset.management_form }}
        <!-- table headers -->
        <thead>
          <tr>
            <th scope="col">Order #</th>
            <th scope="col">Client</th>
            <th scope="col">Discount (€)</th>
            <th scope="col">Deposit (€)</th>
            <th scope="col">Order Value (€)</th>
            <th scope="col">Created On</th>
            <th scope="col">Updated On</th>
            <th scope="col">Order Status</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- loop through order and form objects -->
          {% for order, form in order_forms %}
          <tr>
            <!-- Populate order row values -->
            <th scope="row">{{ order.id }}</th>
            <td>{{ order.client.client_name }}</td>
            <td>{{ order.discount|default_if_none:"0.00" }}</td>
            <td>{{ order.deposit|default_if_none:"0.00" }}</td>
            <td>{{ order.order_value }}</td>
            <td>{{ order.created_on }}</td>
            <td>{{ order.updated_on }}</td>
            <td>{{ form.order_status }}</td>
            <td>
              <button type="submit" name="delete_order" class="btn btn-danger" value="{{ order.id }}"
                onclick="return confirm('Are you sure you want to delete this order?');">
                Delete
              </button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <!-- Save All Changes button -->
    <button type="submit" class="btn btn-primary">Save All Changes</button>
</div>
{% endblock %}